<!--This template is based on: https://dribbble.com/shots/6531694-Marketing-Dashboard by Gregoire Vella -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Dashboard - 45</title>
    <meta name="description" content="description here">
    <meta name="keywords" content="keywords,here">

    <link href="/font/css/all.css" rel="stylesheet">
    <link href="/css/tailwind.min.css" rel="stylesheet">
    <script src="/env/env.js"></script>
    
    <!-- sidebar -->
    <style>
        #sidebar {
            transition: ease-in-out all .1s;
            z-index: 9999;
        }

        #sidebar span {
            opacity: 0;
            position: absolute;
            transition: ease-in-out all .1s;
        }

        #sidebar:hover {
            width: 180px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            /*shadow-2xl*/
        }

        #sidebar:hover span {
            opacity: 1;
        }
    </style>

</head>

<body class="flex bg-gray-100 select-none font-sans">

    <!-- Side bar-->
    <div id="sidebar" class="h-screen w-16 menu bg-white text-white px-4 flex items-center static fixed shadow">

        <ul class="list-reset">
            <li class="my-2 md:my-0">
                <a href="/dashboard"
                    class="block py-1 md:py-3 pl-1 align-middle text-gray-600 no-underline hover:text-indigo-400">
                    <i class="fas fa-home fa-fw mr-3 text-xl"></i><span class="w-full inline-block text-lg">Dashboard</span>
                </a>
            </li>
            <li class="my-2 md:my-0">
                <a href="/graphLHS"
                    class="block py-1 md:py-3 pl-1 align-middle text-gray-600 no-underline hover:text-indigo-400">
                    <i class="fas fa-chart-area fa-fw mr-3 text-xl"></i><span class="w-full inline-block text-lg">Graph:
                        LHS</span>
                </a>
            </li>
            <li class="my-2 md:my-0">
                <a href="/graphRHS"
                    class="block py-1 md:py-3 pl-1 align-middle text-gray-600 no-underline hover:text-indigo-400">
                    <i class="fas fa-chart-area fa-fw mr-3 text-xl"></i><span class="w-full inline-blocktext-lg">Graph:
                        RHS</span>
                </a>
            </li>
            <li class="my-2 md:my-0">
                <a href="/history"
                    class="block py-1 md:py-3 pl-1 align-middle text-gray-600 no-underline hover:text-indigo-400">
                    <i class="fas fa-history fa-fw mr-3 text-xl"></i><span class="w-full pb-1 text-lg">History</span>
                </a>
            </li>
            <li class="my-2 md:my-0">
                <a href="/dido" class="block py-1 md:py-3 pl-1 align-middle text-gray-600 no-underline hover:text-indigo-400">
                    <i class="fas fa-exchange-alt fa-fw mr-3 text-xl"></i><span
                        class="w-full inline-blocktext-lg">DI/DO</span>
                </a>
            </li>
            <li class="my-2 md:my-0">
                <a href="/analytics"
                    class="block py-1 md:py-3 pl-1 align-middle text-gray-600 no-underline hover:text-indigo-400">
                    <i class="fas fa-folder fa-fw mr-3 text-indigo-400 text-xl"></i><span class="w-full inline-block text-lg">Reports</span>
                </a>
            </li>
            <li class="my-2 md:my-0">
                <a href="/processsetup"
                    class="block py-1 md:py-3 pl-1 align-middle text-gray-600 no-underline hover:text-indigo-400">
                    <i class="fa fa-wrench fa-fw mr-3 text-xl"></i><span class="w-full inline-block text-lg">Settings</span>
                </a>
            </li>
        
        </ul>
    </div>

    <div class="flex flex-1 max-h-full pl-16">

        <!--Dash Content -->
        <div id="dash-content" class="bg-blue-200 py-3 px-2 lg:py-0 w-full xl:w-80 lg:max-w-sm flex flex-wrap content-start">

            <!-- Batch Report -->
            <div class="w-1 w-full">
                <div onclick="location.href='/analytics'"
                    class="border-2 border-gray-900 border-dashed hover:border-transparent bg-white hover:shadow-xl rounded px-6 py-3 m-2 md:mx-10 md:my-6">
                    <div class="flex flex-col text-center">
                        <div class="flex-1 items-center">
                            <h5 class="font-bold uppercase text-gray-900">Batch Report</h5>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Audit Report -->
            <div class="w-1 w-full">
                <div onclick="location.href='/audit'"
                    class="cursor-pointer border-2 border-gray-900 border-dashed hover:border-transparent hover:bg-white hover:shadow-xl rounded px-6 py-3 m-2 md:mx-10 md:my-6">
                    <div class="flex flex-col text-center">
                        <div class="flex-1">
                            <h5 class="font-bold uppercase text-gray-700">Audit Report</h5>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Alarm Report -->
            <div class="w-1 w-full">
                <div onclick="location.href='/alarm'"
                    class="cursor-pointer border-2 border-gray-900 border-dashed hover:border-transparent hover:bg-white hover:shadow-xl rounded px-6 py-3 m-2 md:mx-10 md:my-6">
                    <div class="flex flex-col text-center">
                        <div class="flex-1">
                            <h5 class="font-bold uppercase text-gray-700">Alarm Report</h5>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Batch List -->
            <div class="w-full overflow-y-auto select-text p-3" style="height:30vh;">
                <div class="border border-gray-400 bg-white rounded shadow">
                    <div class="border-b border-gray-400 p-3">
                        <h5 class="font-bold uppercase text-center text-xl text-black">Total
                            Batches:
                            <a id="batchcount" class="font-bold text-xl text-black">0
                            </a>
                        </h5>
                    </div>
                    <div class="px-5 pb-3">
                        <table class="table-fixed w-full text-center text-black" height="170rem">
                            <thead>
                                <tr>
                                    <th class="text-center py-3" style="width:60px">Index</th>
                                    <th class="text-center py-3">Batch Name</th>
                                </tr>
                            </thead>
                        
                            <tbody id="batchlist">
                            
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>

        <!--Graph Content -->
        <div id="main-content" class="w-full h-screen flex-1">

            <div class="flex flex-1 flex-wrap">
                <div class="w-full p-6 ">

                    <!-- Search: Parameters -->
                    <div class="border-b mt-2 p-3">
                        <h5 class="font-bold text-black">Enter Batch Number:</h5>
                    </div>
                    
                    <div class="flex grid grid-cols-3 p-3 ">
                    
                        <div class="flex flex-col">
                            <div class="flex flex-row">
                                <div class="py-3">
                                    <input id="batchname"
                                        class="bg-white border-gray-500 shadow focus:outline-none focus:shadow-outline border border-gray-300 rounded-lg py-2 px-2 block w-full"
                                        type="text" placeholder="" onkeydown="if (event.keyCode == 13) searchBatch()">
                                </div>
                                <div class="p-3">
                                    <button id="searchbatch"
                                        class="bg-blue-100 uppercase text-sm hover:bg-blue-500 text-gray-800 font-semibold hover:text-white py-2 px-5 border border-blue-500 hover:border-transparent rounded"
                                        onclick="searchBatch()">
                                        SEARCH
                                    </button>
                                </div>
                            </div>
                        </div>
                    
                    </div>

                    <!-- Search: Parameters -->
                    <div class="border-b mt-2 p-3">
                        <h5 class="font-bold text-black">Enter Rotation Number Range:</h5>
                    </div>
                    
                    <div class="flex grid p-3">
                        <h3 class="font-bold mt-2 text-lg">Total Data points: <a id="total_data">0</a></h3>
                    
                    </div>

                    <div class="flex grid grid-cols-3 p-3 ">

                        <div class="flex flex-col">
                            <h3> From Data  </h3>
                            <div class="flex flex-row">
                                <div class="py-3">
                                    <input id="fromRotationNumber"
                                        class="bg-white border-gray-500 shadow focus:outline-none focus:shadow-outline border border-gray-300 rounded-lg py-2 px-2 block w-full"
                                        type="number" placeholder="" onkeydown="if (event.keyCode == 13) filterbutton()">
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col">
                            <h3> To Data </h3>
                            <div class="flex flex-row">
                                <div class="py-3">
                                    <input id="toRotationNumber"
                                        class="bg-white border-gray-500 shadow focus:outline-none focus:shadow-outline border border-gray-300 rounded-lg py-2 px-2 block w-full"
                                        type="number" placeholder="" onkeydown="if (event.keyCode == 13) filterbutton()">
                                </div>
                                <div class="p-3">
                                    <button
                                        class="bg-blue-100 uppercase text-sm hover:bg-blue-500 text-gray-800 font-semibold hover:text-white py-2 px-5 border border-blue-500 hover:border-transparent rounded"
                                        onclick="filterbutton()">
                                        Filter
                                    </button>
                                </div>
                            </div>
                        </div>
                    
                    </div>

                    <!-- Export:  -->
                    <div class="border-b mt-2 p-3">
                        <h5 class="font-bold text-black">Export:</h5>
                    </div>
                    
                    <div class="flex grid grid-cols-3 p-3 ">
                    
                        <div class="flex flex-wrap p-3">

                            <!-- PDF report Button -->
                            <div class="py-3">
                                <button id="generatepdfreport"
                                    class="bg-blue-100 uppercase text-sm hover:bg-blue-500 text-gray-800 font-semibold hover:text-white py-2 px-10 border border-blue-500 hover:border-transparent rounded"
                                    onclick="generateReport()">
                                    PDF report
                                </button>
                            </div>
                        </div>

                        <div class="flex flex-wrap p-3">
                        
                            <!-- Excel Button -->
                            <div class="py-3">
                                <button
                                    class="bg-blue-100 uppercase text-sm hover:bg-blue-500 text-gray-800 font-semibold hover:text-white py-2 px-10 border border-blue-500 hover:border-transparent rounded"
                                    onclick="csvexport()">
                                    Excel EXPORT
                                </button>
                            </div>
                        </div>
                    
                    </div>

                    <!--"Container" for the graphs"-->
                    <div class="max-w-full">

                        <!--Steps for report export-->
                        <!-- <div class="w-64 pl-5"> -->
                            <!-- <div class="border-b p-3">
                                <h5 class="font-bold text-black">Step 1: Enter Batch Number</h5>
                            </div> -->
                            <!-- Search Button -->
                            <!-- <div class="flex flex-wrap p-3">
                                <form id="batchname" class="">
                                    <input
                                        class="bg-white focus:outline-none focus:shadow-outline border border-gray-300 rounded-lg py-2 px-2 block w-60"
                                        type="text" placeholder="">
                                </form>
                            </div> -->
                        
                            <!-- Search Button -->
                            <!-- <div class="flex-wrap flex p-3">
                                <button id="searchbatch"
                                    class="bg-blue-100 uppercase text-sm hover:bg-blue-500 text-gray-800 font-semibold hover:text-white py-2 px-10 border border-blue-500 hover:border-transparent rounded"
                                    onclick="searchBatch()">
                                    SEARCH
                                </button>
                            </div> -->
                        
                            <!-- <div class="border-b p-3">
                                <h5 class="font-bold text-black">Step 2: Enter Range</h5>
                            </div> -->
                            <!-- Search Button -->
                            <!-- <div class="flex flex-wrap p-3">
                                <form id="fromRotationNumber" class="py-3">
                                    <input
                                        class="bg-white focus:outline-none focus:shadow-outline border border-gray-300 rounded-lg py-2 px-2 block w-40"
                                        type="number" placeholder="FROM">
                                </form>
                                
                                <form id="toRotationNumber" class="py-3">
                                    <input
                                        class="bg-white focus:outline-none focus:shadow-outline border border-gray-300 rounded-lg py-2 px-2 block w-40"
                                        type="number" placeholder="TO">
                                </form>
                        
                            </div> -->
                        
                            <!-- Filter Button -->
                            <!-- <div class="flex flex-wrap p-3">
                                <div class="">
                                    <button
                                        class="bg-blue-100 uppercase text-sm hover:bg-blue-500 text-gray-800 font-semibold hover:text-white py-2 px-10 border border-blue-500 hover:border-transparent rounded"
                                        onclick="filterbutton()">
                                        Filter
                                    </button>
                                </div>
                            </div> -->
                        
                            <!-- <div class="border-b p-3">
                                <h5 class="font-bold text-black">Step 3: Export Report</h5>
                            </div> -->
                        
                            <!-- PDF report Button -->
                            <!-- <div class="flex flex-wrap p-3">
                                <div class="py-3">
                                    <button id="generatepdfreport"
                                        class="bg-blue-100 uppercase text-sm hover:bg-blue-500 text-gray-800 font-semibold hover:text-white py-2 px-10 border border-blue-500 hover:border-transparent rounded"
                                        onclick="generateReport()">
                                        PDF report
                                    </button>
                                </div>
                            </div> -->
                        
                            <!-- <div class="border-b p-3">
                                <h5 class="font-bold text-black">CSV / Excel:</h5>
                            </div> -->
                            
                            <!-- CSV Button -->
                            <!-- <div class="flex flex-wrap p-3">
                                <div class="py-3">
                                    <button
                                        class="bg-blue-100 uppercase text-sm hover:bg-blue-500 text-gray-800 font-semibold hover:text-white py-2 px-10 border border-blue-500 hover:border-transparent rounded"
                                        onclick="csvexport()">
                                        CSV EXPORT
                                    </button>
                                </div>
                            </div> -->
                        
                            <!--/Graph Card-->
                        
                        <!-- </div> -->

                        <!-- Rotation Avg List -->
                        <div class="w-full p-3">
                            <div class="border border-gray-400 rounded shadow overflow-auto">
                                <div class="border-b border-gray-400 p-3">
                                    <h5 class="font-bold uppercase text-center text-3xl text-black">Total
                                        Rotations:
                                        <a id="totalrotations" class="font-bold text-3xl text-black">
                                        </a>
                                    </h5>
                                </div>
                                <div class="px-5 pb-5">
                                    <table class="table-fixed w-full text-center text-black" height="170rem">
                                        <thead>
                                            <tr>
                                                <th class="text-center border-b py-3">Rotation</th>
                                                <th class="text-center border-b py-3">PRE LHS AVG<br> (kN)</th>
                                                <th class="text-center border-b py-3">PRE RHS AVG<br> (kN)</th>
                                                <th class="text-center border-b py-3">MAIN LHS AVG<br> (kN)</th>
                                                <th class="text-center border-b py-3">MAIN RHS AVG<br> (kN)</th>
                                                <th class="text-center border-b py-3">EJN LHS AVG<br> (kN)</th>
                                                <th class="text-center border-b py-3">EJN RHS AVG<br> (kN)</th>
                                                <th class="text-center border-b py-3">Dwell Time</th>
                                                <th class="text-center border-b py-3">Turret RPM</th>
                                            
                                            </tr>
                                        </thead>

                                        <tbody id="avgtable">

                                        </tbody>
                                    </table>
                               </div>
                            </div>
                        </div>
                    </div>

                </div>

            </div>

        </div>

    </div>


    <!-- Update Batch details -->
    <script>
        batchtable()

        async function batchtable() {
            const batchResponse = await fetch(batchURL);
            const batch = await batchResponse.json();

            document.getElementById("batchcount").innerHTML = batch.batchcount;

            console.log(batch.batchnames);

            let batchlistt = batch.batchnames;

            loadbatchlist();

            function loadbatchlist() {
                const batchListBody = document.getElementById('batchlist');
                let batchHTML = '';

                let i = -1;
                let j = 0;
                for (let batchh of batchlistt) {
                    i++;
                    j++;
                    batchHTML += `<tr><td class="border border-gray-400 px-4 py-2">${j}</td><td class="border border-gray-400 px-4 py-2">${batchlistt[i]}</td></tr>`
                }

                batchListBody.innerHTML = batchHTML;
            }
        }
    </script>
    
    <!-- Search Avg Data -->
    <script>
        
        // addEventListener("keydown", function (event) {
        //     if (event.keyCode === 13) {
        //         event.preventDefault();

        //         searchBatch();
        //     }
        // });

        var element2 = document.getElementById("searchbatch");

        async function searchBatch() {

            var name = document.getElementById("batchname").value;
            
            console.log(name)

            if (name == "") {

            } else {

                document.getElementById("searchbatch").innerText = "PLEASE WAIT";
                element2.classList.add("cursor-not-allowed");

                dbsearchURL
                var queryAvgURL = `${dbsearchURL}/${name}/average`
                // var queryAvgURL = `${searchAvgURL}${name}`

                const avgData = await fetch(queryAvgURL);
                const avggbatch = await avgData.json();

                
                document.getElementById("totalrotations").innerHTML = avggbatch.count;
                document.getElementById("total_data").innerHTML = avggbatch.count;

                let avglistt = avggbatch.data;

                function loadavglist() {
                    const avgListBody = document.getElementById('avgtable');
                    let avgHTML = '';

                    let i = -1;
                    for (let avgg of avglistt) {
                        i++;
                        let avgdataa = avggbatch.data[i]
                        avgHTML += `<tr><td class="border border-gray-500 px-4 py-2">${avgdataa[8]}</td><td class="border border-gray-500 px-4 py-2">${avgdataa[6]}</td><td id="p1-ejn" class="border border-gray-500 px-4 py-2">${avgdataa[7]}</td><td id="p1-ejn" class="border border-gray-500 px-4 py-2">${avgdataa[4]}</td><td id="p1-ejn" class="border border-gray-500 px-4 py-2">${avgdataa[5]}</td><td id="p1-ejn" class="border border-gray-500 px-4 py-2">${avgdataa[2]}</td><td id="p1-ejn" class="border border-gray-500 px-4 py-2">${avgdataa[3]}</td><td id="p1-ejn" class="border border-gray-500 px-4 py-2">${avgdataa[1]}</td><td id="p1-ejn" class="border border-gray-500 px-4 py-2">${avgdataa[9]}</td></tr>`
                    }

                    avgListBody.innerHTML = avgHTML;
                }

                loadavglist();

                document.getElementById("searchbatch").innerText = "SEARCH";
                element2.classList.remove("cursor-not-allowed");

            }
        }

        async function filterbutton() {

            const avgListBody = document.getElementById('avgtable');
            let avgHTML = '';
            avgListBody.innerHTML = avgHTML;

            var fromname = document.getElementById("fromRotationNumber").value;
            var toname = document.getElementById("toRotationNumber").value;
            var bname = document.getElementById("batchname").value;
            
            const queryAvgURL = `${hostname}/api/search/average/csv/${bname}`

            // console.log(bname);

            const avgData = await fetch(queryAvgURL);
            const avggbatch = await avgData.json();

            // console.log(avggbatch)

            let avglistt = avggbatch;

            let from = fromname;
            let to = toname;

            function loadavglist() {
                const avgListBody = document.getElementById('avgtable');
                let avgHTML = '';

                let i = -1;
                let j = 0;

                for (let avgg of avglistt) {
                    i++;
                    if (i >= from && i <= to) {
                        j = i - 1;
                        from++;
                        let avgdataa = avggbatch[j]
                        avgHTML += `<tr><td class="border border-gray-500 px-4 py-2">${avgdataa[8]}</td><td class="border border-gray-500 px-4 py-2">${avgdataa[6]}</td><td id="p1-ejn" class="border border-gray-500 px-4 py-2">${avgdataa[7]}</td><td id="p1-ejn" class="border border-gray-500 px-4 py-2">${avgdataa[4]}</td><td id="p1-ejn" class="border border-gray-500 px-4 py-2">${avgdataa[5]}</td><td id="p1-ejn" class="border border-gray-500 px-4 py-2">${avgdataa[2]}</td><td id="p1-ejn" class="border border-gray-500 px-4 py-2">${avgdataa[3]}</td><td id="p1-ejn" class="border border-gray-500 px-4 py-2">${avgdataa[1]}</td><td id="p1-ejn" class="border border-gray-500 px-4 py-2">${avgdataa[9]}</td></tr>`
                    } else if (i > to) {
                        // await fetch(generatereportURL);
                    }
                }

                avgListBody.innerHTML = avgHTML;
            }

            loadavglist();

        }

    </script>
    
    <!-- Generate PDF Report -->
    <script>
        var element = document.getElementById("generatepdfreport");

        var pdfgenerationtime = 10000;

        async function generateReport() {

            var a = document.getElementById("fromRotationNumber").value;
            var fromname = a;
            
            var b = document.getElementById("toRotationNumber").value;
            var toname = b;

            var c = document.getElementById("batchname").value;
            var bname = c;
            

            if (fromname == "" || toname == "" || bname == "" || parseInt(fromname) > parseInt(toname)) {
                window.alert("Enter valid Batch Name, Start and Stop Rotation Number  ");
            } else {
                document.getElementById("generatepdfreport").innerText = "PLEASE WAIT";
                element.classList.add("cursor-not-allowed");

                var queryAvgURL = `${reportAvgURL}/${bname}/${fromname}/${toname}`
                await fetch(queryAvgURL);
                await fetch(reportAvgGenURL);

                setTimeout(() => {
                    location.href = "/report/average/download"
                    document.getElementById("generatepdfreport").innerText = "PDF REPORT";
                    element.classList.remove("cursor-not-allowed");
                }, pdfgenerationtime);
            }
        }
    </script>
    
    <!-- CSV Export -->
    <script>
        function exportToCsv(filename, rows) {
            var processRow = function (row) {
                var finalVal = '';
                for (var j = 0; j < row.length; j++) {
                    var innerValue = row[j] === null ? '' : row[j].toString();
                    if (row[j] instanceof Date) {
                        innerValue = row[j].toLocaleString();
                    };
                    var result = innerValue.replace(/"/g, '""');
                    if (result.search(/("|,|\n)/g) >= 0)
                        result = '"' + result + '"';
                    if (j > 0)
                        finalVal += ',';
                    finalVal += result;
                }
                return finalVal + '\n';
            };

            var csvFile = '';
            for (var i = 0; i < rows.length; i++) {
                csvFile += processRow(rows[i]);
            }

            var blob = new Blob([csvFile], { type: 'text/csv;charset=utf-8;' });
            if (navigator.msSaveBlob) { // IE 10+
                navigator.msSaveBlob(blob, filename);
            } else {
                var link = document.createElement("a");
                if (link.download !== undefined) { // feature detection
                    // Browsers that support HTML5 download attribute
                    var url = URL.createObjectURL(blob);
                    link.setAttribute("href", url);
                    link.setAttribute("download", filename);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
            }
        }

        async function csvexport() {

            var name = document.getElementById("batchname").value;
            
            var csvAvgURL = `${dbsearchcsvURL}/${name}/history`;

            const batchResponse = await fetch(csvAvgURL);
            const csvdata = await batchResponse.json();

            //  bi_L_force_line bi_L_rjn_high bi_L_rjn_low bi_R_force_line bi_R_rjn_high bi_R_rjn_low mode mono_force_line mono_rjn_high mono_rjn_low p10LHSejn p10LHSmain p10LHSpre p10RHSejn p10RHSmain p10RHSpre p11LHSejn p11LHSmain p11LHSpre p11RHSejn p11RHSmain p11RHSpre p12LHSejn p12LHSmain p12LHSpre p12RHSejn p12RHSmain p12RHSpre p13LHSejn p13LHSmain p13LHSpre p13RHSejn p13RHSmain p13RHSpre p14LHSejn p14LHSmain p14LHSpre p14RHSejn p14RHSmain p14RHSpre p15LHSejn p15LHSmain p15LHSpre p15RHSejn p15RHSmain p15RHSpre p16LHSejn p16LHSmain p16LHSpre p16RHSejn p16RHSmain p16RHSpre p17LHSejn p17LHSmain p17LHSpre p17RHSejn p17RHSmain p17RHSpre p18LHSejn p18LHSmain p18LHSpre p18RHSejn p18RHSmain p18RHSpre p19LHSejn p19LHSmain p19LHSpre p19RHSejn p19RHSmain p19RHSpre p1LHSejn p1LHSmain p1LHSpre p1RHSejn p1RHSmain p1RHSpre p20LHSejn p20LHSmain p20LHSpre p20RHSejn p20RHSmain p20RHSpre p21LHSejn p21LHSmain p21LHSpre p21RHSejn p21RHSmain p21RHSpre p22LHSejn p22LHSmain p22LHSpre p22RHSejn p22RHSmain p22RHSpre p23LHSejn p23LHSmain p23LHSpre p23RHSejn p23RHSmain p23RHSpre p24LHSejn p24LHSmain p24LHSpre p24RHSejn p24RHSmain p24RHSpre p25LHSejn p25LHSmain p25LHSpre p25RHSejn p25RHSmain p25RHSpre p26LHSejn p26LHSmain p26LHSpre p26RHSejn p26RHSmain p26RHSpre p27LHSejn p27LHSmain p27LHSpre p27RHSejn p27RHSmain p27RHSpre p28LHSejn p28LHSmain p28LHSpre p28RHSejn p28RHSmain p28RHSpre p29LHSejn p29LHSmain p29LHSpre p29RHSejn p29RHSmain p29RHSpre p2LHSejn p2LHSmain p2LHSpre p2RHSejn p2RHSmain p2RHSpre p30LHSejn p30LHSmain p30LHSpre p30RHSejn p30RHSmain p30RHSpre p31LHSejn p31LHSmain p31LHSpre p31RHSejn p31RHSmain p31RHSpre p32LHSejn p32LHSmain p32LHSpre p32RHSejn p32RHSmain p32RHSpre p33LHSejn p33LHSmain p33LHSpre p33RHSejn p33RHSmain p33RHSpre p34LHSejn p34LHSmain p34LHSpre p34RHSejn p34RHSmain p34RHSpre p35LHSejn p35LHSmain p35LHSpre p35RHSejn p35RHSmain p35RHSpre p36LHSejn p36LHSmain p36LHSpre p36RHSejn p36RHSmain p36RHSpre p37LHSejn p37LHSmain p37LHSpre p37RHSejn p37RHSmain p37RHSpre p38LHSejn p38LHSmain p38LHSpre p38RHSejn p38RHSmain p38RHSpre p39LHSejn p39LHSmain p39LHSpre p39RHSejn p39RHSmain p39RHSpre p3LHSejn p3LHSmain p3LHSpre p3RHSejn p3RHSmain p3RHSpre p40LHSejn p40LHSmain p40LHSpre p40RHSejn p40RHSmain p40RHSpre p41LHSejn p41LHSmain p41LHSpre p41RHSejn p41RHSmain p41RHSpre p42LHSejn p42LHSmain p42LHSpre p42RHSejn p42RHSmain p42RHSpre p43LHSejn p43LHSmain p43LHSpre p43RHSejn p43RHSmain p43RHSpre p44LHSejn p44LHSmain p44LHSpre p44RHSejn p44RHSmain p44RHSpre p45LHSejn p45LHSmain p45LHSpre p45RHSejn p45RHSmain p45RHSpre p4LHSejn p4LHSmain p4LHSpre p4RHSejn p4RHSmain p4RHSpre p5LHSejn p5LHSmain p5LHSpre p5RHSejn p5RHSmain p5RHSpre p6LHSejn p6LHSmain p6LHSpre p6RHSejn p6RHSmain p6RHSpre p7LHSejn p7LHSmain p7LHSpre p7RHSejn p7RHSmain p7RHSpre p8LHSejn p8LHSmain p8LHSpre p8RHSejn p8RHSmain p8RHSpre p9LHSejn p9LHSmain p9LHSpre p9RHSejn p9RHSmain p9RHSpre rotation

            csvdata[0] = ['Time', 'Rotation', 'Pre LHS Avg', 'Main LHS Avg', 'Ejn LHS Avg', 'Pre RHS Avg', 'Main RHS Avg', 'Ejn RHS Avg']

            if (typeof csvdata !== 'undefined' && csvdata.length > 0) {
                exportToCsv(`${name}.csv`, csvdata)
            }

        }

    </script>
    
</body>

</html>